# 采集 / 噪声滤除



严重注意，以下任何一个领域，都有不少学术论文可以做参考，广泛查阅，汲取前人有效经验，能够切实提高和落地。



## 采集漂移消除



一般为正负输入端，正输入端 通常 通过开关（继电器等）连通到 负输入端（如 "地" 等），即正负输入端短接，此时进行测量，得到零点偏移值，开始测量信号的时候减去该零点漂移值即可。类似电子秤的 "去皮" 功能。



考虑 温漂 等的影响，可以在 不同工况下（如不同温度、湿度、气压 等等条件，按需选取）进行大量试验，形参数据表格，后面采集量再通过查表进行补偿，也叫做 校准 环境。若采集设备的一致性比较好，则可以只校准几次获得校准数据，对后面新生产的采集设备基于校准数据便可直接用，也有较好的测量性能。



器件的选型，应大范围广泛搜集，选择性能够且价格合适的。若预算紧张且有较便宜的器件但是其性能指标范围较广（涵盖需求的测量指标范围），则多买一些，进行挑选，也可以做到性价比。



## 工频噪声滤除



措施合集

[如何在实时ADC采集模拟信号时就把工频干扰给滤除？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/660169032/answer/3597491945)。

> 硬件滤波器
>
> - 低通滤波器：在信号进入ADC之前使用一个低通滤波器，其截止频率略低于工频（比如40-45 Hz）。这样可以有效衰减50/60 Hz及其高次谐波干扰。
> - 带阻滤波器（陷波器）：设计一个中心频率为50 Hz（或60 Hz）的带阻滤波器，可以有效抑制工频干扰，同时保留信号的其他部分。
>
> 同步采样
>
> - 同步采样：如果采样频率是工频的整数倍（如1000 Hz），可以在采样过程中通过平均多个周期的数据来减小工频干扰的影响。这种方法假设干扰是周期性的，通过周期内的积分或平均可以抵消干扰。
> - 同步检测：使用一个锁相环（PLL）电路来同步检测工频信号，生成一个与工频相同频率的参考信号。然后在ADC输入信号中减去这个参考信号以消除干扰。
>
> 数字滤波
>
> - FIR/IIR数字滤波器：在ADC采样之后，通过数字滤波器（如FIR或IIR滤波器）在数字域对数据进行处理，去除50/60 Hz的干扰。FIR滤波器可以设计为一个高精度的带阻滤波器，而IIR滤波器则可以通过较少的计算量实现类似的效果。
> - 自适应滤波：使用自适应滤波器（如LMS算法）动态跟踪和消除工频干扰。自适应滤波器能够在信号变化时自动调整，以更好地去除干扰。
>
> 差分放大
>
> - 差分输入：使用差分放大器来减少共模干扰。如果工频干扰主要表现为共模噪声，那么差分放大器可以有效减少这种干扰。
>
> 屏蔽和接地
>
> - 电磁屏蔽：在ADC电路设计中，使用适当的屏蔽和接地技术，以减少来自电网的电磁干扰。
> - 滤波电容：在ADC输入端使用适当的滤波电容，以滤除高频干扰，包括工频干扰的高次谐波。
>
> 平均法
>
> - 多次采样平均：对同一信号进行多次采样并取平均值，可以有效减少工频噪声的影响，因为工频噪声在多次采样中可能会相互抵消。
> - 滑动窗口滤波等。



硬件上的：

无源双T陷波滤波器

[《信号与系统》4.10.2工频干扰的滤除_抑制工频干扰需要什么滤波器-CSDN博客](https://blog.csdn.net/qq_32589131/article/details/105614591)。

接地可以有效地减少工频干扰对电路的影响。同时，要避免接地回路中的干扰，可以通过使用单点接地或者多点接地的方式来实现。



软件上的：

FIR 软件数字滤波

[如何把50Hz工频干扰定点清除-电子发烧友网 (elecfans.com)](https://www.elecfans.com/d/2096500.html)。

关于 FIR / IIR 滤波器设计和实现，可以通过 python 库 scipy.signal 做，可具体问 AI 工具 和 查阅官方文档。



## RC / LC 用处注意



- 磁珠+电容 用于LDO前的电源滤波。滤波频段覆盖前级 DC-DC 开关电源 输出的噪声频段，以及覆盖 后级 LDO 的 PSRR 不力的频段。 

- 电阻 + 电容 （RC，R为10Ω左右，注意电阻功率限制，注意压降，注意时间常数造成的延时启动，注意负载突变造成的电压恢复时间，注意R的电压噪声（推荐使用金属膜材质电阻））推荐 用于运放、ADC等精密信号IC供电滤波。

  纯MLCC的ESR很小，高频噪声抑制好，但是中频不足（100KHz到1MHz，MLCC自谐振点也在此附近），对于精密链路，酌情使用电源RC滤波（注意以上的注意点）。

- 电感 + 电容（LC）多用于信号滤波，注意调节L和C的值以及串电阻（或使用带有一定ESR的C比如钽电容等）等避免LC的谐振尖峰，多仿真。

  高频噪声滤波（比如10KHz以上，1MHz以上，电感在低频段比如＜100KHz的感抗有限）可以上LC但需要解决谐振峰值（依靠上阻尼来优化，比如C选择钽电容，ESR在0.5到2Ω，因此 如果要用 LC 用于 LDO 前的滤波环节，其中 C 可以用 钽电容，但是钽电容过压易炸且有火花，可能有安规问题）



## 电源滤波



电源入口的 EMC 电路（电容 — 共模电感 — 电容，电容选择 固态电容 与 MLCC）），对于各种电压电流的电源，有很多 EMC 参考电路。



磁珠针对高频（100MHz 以上），电感针对中低频（50Mhz 以内），这只笼统的说。

DC-DC 输出，含有较多 高频噪声，而 LDO 的 PSRR 频带 在高频 一般表现不佳，因此 DC-DC 输出 可先接 磁珠 或 电感，再 接往 LDO，涵盖住 LDO 的 PSRR 力不从心的 频带，使得电源输出的大范围频带内噪声基本都可以得以压制。



更多可见 `SCH & PCB 设计规范和 AD 的使用` 一文中的 电源 相关的章节。



## 运放信号调理电路 防噪声处理



保护环 Guard Ring 处理。可见各种 TIA 运放的参考手册，有讲到 guard ring 处理，如 lmp7721、ADA4530 等。guard ring 也可用于 放大器电路，减小干扰。

信号敏感电路部分的 金属屏蔽罩 处理。



更多可见 `SCH & PCB 设计规范和 AD 的使用` 一文中的 运放 相关的章节。

更多参考 `TIA弱电流测量措施和经验汇总` 一文。



## 数模混合电路接地

基础接地背景经验参考 `额外文档\关于接地-解决共地干扰` 文件夹里面文档。



TODO: 找一些官方的好的ADC和mcu板子的PCB实例分析分析



接地相关的实用技术文章
https://www.linkedin.com/pulse/grounding-techniques-pcb-design-comprehensive-guide-techlanz-6ylve/
https://www.ti.com/lit/an/slyt499/slyt499.pdf?ts=1745290597053&ref_url=https%253A%252F%252Fwww.google.com.hk%252F
https://www.ti.com/lit/an/slyt512/slyt512.pdf?ts=1745278813693&ref_url=https%253A%252F%252Fwww.google.com%252F

https://www.analog.com/en/resources/technical-articles/successful-pcb-grounding-with-mixedsignal-chips--follow-the-path-of-least-impedance.html
https://www.edn.com/successful-pcb-grounding-with-mixed-signal-chips-part-3-power-currents-and-multiple-mixed-signal-ics/
https://www.lioncircuits.com/blog/posts/high-speed-hardware-design-part-3?srsltid=AfmBOorfjkLtNDf-Yd-qmdcFb6ptC9Vi9aTISiV2tl2Yx_v5P8gDTa3v

https://resources.altium.com/p/how-properly-ground-adcs

https://electronics.stackexchange.com/questions/659033/how-to-design-a-schematic-and-pcb-for-an-adc-using-separated-grounds



https://www.renesas.cn/zh/document/apn/best-practices-analog-pcb-layout-using-ra2a1-mcu

这里面52、53页说明数模混合电路的PCB布局。
https://ww1.microchip.com/downloads/en/DeviceDoc/MCP3913-3V-Six-Channel-Analog-Front-End-DS20005227C.pdf



## 保护相关



电源电路：

- 电源 入口 的 TVS 管 等。电源 按需添加 欠压、过压（保护后面电路）、过流（以及防短路）、防反接、过温 等保护电路，或 软件控制（软件要高可靠、看门狗、专用硬件复位 等等） 等。

  对于低电压、地电流小电路来说，自恢复保险丝 + 稳压管 就可以实现 过压保护、过流保护 和 防反接，性价比好。

- 消火花电路 等，并 TVS，串 RC，继电器 驱动端 等 电感 电路 的并入 反接 二极管 续流 等。

- 并电容防电压突变，串电感防电流突变。




敏感 IO 接口：

- IO 口 的 ESD 管。对外 数字接口的 ESD 防护（对外信号，先经过 ESD，再串上电阻比如 1K）.

- 光耦隔离。

- 通讯线 专用隔离芯片 等。



可参考 硬件规范 的 `电源输入设计 & EMC` 和 `保护机制` 等章节 [Staok/thoughs-about-hardware-design: 介绍和罗列关于硬件设计所需要考虑的各个方面。纯个人经验总结，非科班念经。永远地不定期更新。CC-BY-NC-SA 4.0。](https://github.com/Staok/thoughs-about-hardware-design) 。


可参考 `保护类电路&通讯隔离&电平转换`（github 仓库 [Staok/protection-circuits: 对保护电路中的过流、过压、软起动、防反接、通讯和信号隔离、电平转换、防共地干扰、TVS瞬态抑制、共模抑制和电磁兼容做一个大总结 (github.com)](https://github.com/Staok/protection-circuits)） 等。
